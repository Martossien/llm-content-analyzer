# Configuration Brique 2 Content Analyzer V2.3
project:
  name: "llm-content-analyzer"
  version: "2.3.0"
  stack_philosophy: "minimal_dependencies_maximum_efficiency"

api_config:
  url: "http://localhost:8080"
  token: "sk-d88e3244ae2e4b64a5256c6f4946155a"
  max_tokens: 32000
  timeout_seconds: 300
  batch_size: 100

# Configuration tenacity retry
retry_config:
  max_attempts: 3
  wait_strategy: "exponential"
  wait_min: 4
  wait_max: 10
  retry_on: ["requests.RequestException", "requests.Timeout"]

# Configuration circuitbreaker  
circuit_config:
  failure_threshold: 5
  recovery_timeout: 30
  expected_exception: "requests.RequestException"

modules:
  csv_parser:
    library: "pandas"
    chunk_size: 10000
    validation_strict: true
    encoding: "utf-8"
    
  cache_manager:
    backend: "sqlite3_custom"
    max_memory_mb: 512
    ttl_hours: 168  # 7 jours
    compression: false
    
  file_filter:
    backend: "python_native"
    priority_scoring: true
    
  api_client:
    backend: "requests_tenacity_circuitbreaker"
    connection_pool: false
    
  db_manager:
    backend: "sqlite3_pure"
    wal_mode: true
    pragma_optimizations: true
    
  prompt_manager:
    backend: "jinja2_yaml"
    template_caching: true

logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/content_analyzer.log"

exclusions:
  extensions:
    blocked: [".tmp", ".log", ".bak", ".cache"]
    low_priority: [".txt", ".ini", ".cfg"]
    high_priority: [".pdf", ".docx", ".doc", ".xlsx"]
  file_size:
    min_bytes: 100
    max_bytes: 104857600
  file_attributes:
    skip_system: true
    skip_hidden: false
  paths:
    excluded_patterns: []

scoring:
  size_weight: 30
  type_weight: 40
  age_weight: 20
  special_weight: 10

templates:
  comprehensive:
    system_prompt: |
      Tu es un expert en classification de documents d'entreprise avec sp√©cialisation en s√©curit√© informatique, conformit√© RGPD et analyse juridico-financi√®re.

      INSTRUCTIONS CRITIQUES :
      1. Retourne UNIQUEMENT un objet JSON valide, sans texte avant ni apr√®s
      2. Si le fichier est inaccessible, corrompu ou vide : utilise "N/A" pour tous les champs et confidence=0
      3. Sois pr√©cis dans tes classifications selon les standards internationaux
      4. Utilise une confidence de 0-100 pour chaque domaine analys√©

    user_template: |
      ANALYSE DE DOCUMENT - CLASSIFICATION MULTI-DOMAINES

      üìÅ Fichier: {{ file_name }}
      üìä Taille: {{ file_size_readable }}
      üë§ Propri√©taire: {{ owner }}
      üìÖ Derni√®re modification: {{ last_modified }}
      üîç Signature: {{ file_signature }}

      INSTRUCTIONS D'ANALYSE :

      üõ°Ô∏è S√âCURIT√â (Classification selon niveaux gouvernementaux/entreprise) :
      - C0 = Public : Information accessible √† tous sans restriction
      - C1 = Interne : Information limit√©e au personnel de l'organisation
      - C2 = Confidentiel : Information sensible, acc√®s restreint avec autorisation
      - C3 = Secret : Information hautement sensible, acc√®s tr√®s restreint

      üîí RGPD (Selon Art. 4 GDPR - Donn√©es personnelles) :
      - none = Aucune donn√©e personnelle d√©tect√©e
      - low = Donn√©es personnelles basiques (noms, emails professionnels)
      - medium = Donn√©es personnelles sensibles (num√©ros ID, adresses)
      - high = Donn√©es personnelles sp√©ciales (sant√©, biom√©trie, opinions politiques)
      - critical = Donn√©es ultra-sensibles (donn√©es bancaires, secrets m√©dicaux)

      üí∞ FINANCE (Types de documents financiers) :
      - none = Pas de contenu financier
      - invoice = Factures, devis, bons de commande
      - contract = Contrats commerciaux, accords financiers
      - budget = Budgets, pr√©visions, analyses financi√®res
      - accounting = Comptabilit√©, bilans, rapports financiers
      - payment = Informations de paiement, virements, cartes bancaires

      ‚öñÔ∏è L√âGAL (Types de documents juridiques) :
      - none = Pas de contenu juridique
      - employment = Contrats de travail, politiques RH
      - lease = Baux immobiliers, locations
      - sale = Contrats de vente, cessions
      - nda = Accords de confidentialit√©
      - compliance = Documents de conformit√©, audits
      - litigation = Documents judiciaires, proc√©dures

      GESTION D'ERREURS :
      Si le fichier est inaccessible, corrompu, vide ou illisible :
      - Toutes les classifications = "N/A"
      - Toutes les confidences = 0
      - R√©sum√© = "Fichier inaccessible ou corrompu"

      Retourne EXACTEMENT ce JSON (remplace par tes analyses) :
      {
        "resume": "R√©sum√© en 50 mots maximum du contenu principal du document",
        "security": {
          "classification": "C0|C1|C2|C3|N/A",
          "confidence": 85,
          "justification": "Explication concise de la classification"
        },
        "rgpd": {
          "risk_level": "none|low|medium|high|critical|N/A",
          "data_types": ["type1", "type2"],
          "confidence": 90
        },
        "finance": {
          "document_type": "none|invoice|contract|budget|accounting|payment|N/A",
          "amounts": [{"value": "montant", "currency": "EUR", "context": "contexte"}],
          "confidence": 75
        },
        "legal": {
          "contract_type": "none|employment|lease|sale|nda|compliance|litigation|N/A",
          "parties": ["partie1", "partie2"],
          "confidence": 80
        }
      }
  security_focused:
    system_prompt: "Expert s√©curit√©"
    user_template: "Analyse de s√©curit√© pour {{ file_name }}\nClassification :"
